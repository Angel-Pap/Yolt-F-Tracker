<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Yolt-F-Tracker</title>

  <!-- ========== STYLES ========== -->
  <style>
    body {
      font-family: sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
    }
    nav {
      display: flex;
      gap: 1rem;
      padding: 1rem;
      background-color: #f0f0f0;
      justify-content: center;
      flex-wrap: nowrap;
      overflow-x: auto;
    }
    nav button {
      padding: 0.5rem 1rem;
      border: none;
      background: #ddd;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    nav button:hover {
      background: #ccc;
    }
    input, select, button {
      box-sizing: border-box;
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      width: 100%;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background-color: #f4f4f4;
    }
    section {
      display: none;
    }
    section.active {
      display: block;
    }
  </style>
</head>
<body>

  <!-- ========== MAIN NAVIGATION ========== -->
  <nav>
    <button onclick="goTo('home')">üè† Home</button>
    <button onclick="goTo('transactions')">üí∏ Transactions</button>
    <button onclick="goTo('projects')">üèó Projects</button>
    <button onclick="goTo('projection')">üìà Projection</button>
    <button onclick="goTo('options')">‚öôÔ∏è Options</button>
  </nav>

  <!-- ========== MAIN CONTENT ========== -->
  <main>
    <!-- === Home Page === -->
    <section id="homePage">
      <h2>üè† Welcome to Yolt-F-Tracker</h2>
      <p>Select a section from the navigation above to begin.</p>
    </section>

    <!-- === Transactions Page === -->
    <section id="transactionsPage" class="active">
      <h2>üìã Transactions</h2>
      <button onclick="openPopup()" style="font-size: 1.5rem; padding: 0.3rem 1rem; margin-bottom: 1rem;">
        ‚ûï Add New
      </button>
      <table id="transactionsTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </section>

    <!-- === Projects Page Placeholder === -->
    <section id="projectsPage">
      <h2>üèó Projects</h2>
      <p>Coming soon...</p>
    </section>

    <!-- === Projection Page Placeholder === -->
    <section id="projectionPage">
      <h2>üìà Projection</h2>
      <p>Coming soon...</p>
    </section>

    <!-- === Options Page Placeholder === -->
    <section id="optionsPage">
      <h2>‚öôÔ∏è Options</h2>
      <p>Coming soon...</p>
    </section>
  </main>

  <!-- ========== POPUP OVERLAY ========== -->
  <div id="popup" onclick="if(event.target.id==='popup'){ closePopup(); }" style="
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  ">
    <!-- === POPUP BOX === -->
    <div style="
      background: #fff;
      padding: 2rem;
      border-radius: 8px;
      max-width: 400px;
      width: 90%;
      position: relative;
    ">
      <!-- === POPUP HEADER === -->
      <div style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
        width: 100%;
      ">
        <div style="flex: 1;">
          <h3 style="
            margin: 0;
            font-size: 1.2rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
          ">
            New Transaction
          </h3>
        </div>
        <div style="flex-shrink: 0;">
          <button onclick="closePopup()" style="
            font-size: 1.4rem;
            border: none;
            background: transparent;
            cursor: pointer;
            padding: 0 0.5rem;
            line-height: 1;
          ">‚úñ</button>
        </div>
      </div>

<!-- === POPUP FORM === -->
      <form id="transactionForm">
<!-- === ROW 1: Date + Type === -->
            <div style="display: flex; gap: 1rem;">
              <input type="date" id="date" required style="width: calc(50% - 0.5rem);" />
              <select id="type" required style="width: calc(50% - 0.5rem);">
                <option value="">Type</option>
                <option value="Income">Income</option>
                <option value="Expense">Expense</option>
                <option value="Transfer">Transfer</option>
              </select>
            </div>
<!-- === ROW 2: Category + Wallet === -->
            <div style="display: flex; gap: 1rem;">
              <select id="category" required style="width: calc(50% - 0.5rem);" >
                <option value="">Category</option>
                <option value="Advertisement">Advertisement</option>
                <option value="Taxes">Taxes</option>
                <option value="Bank Fees">Bank Fees</option>
                <option value="Tools">Tools</option>
                <option value="Hardware">Hardware</option>
                <option value="Cost of Business">Cost of Business</option>
                <option value="Other">Other</option>
              </select>
              <select id="wallet" required style="width: calc(50% - 0.5rem);" >
                <option value="">Wallet</option>
                <option value="Alpha">Alpha</option>
                <option value="Cash">Cash</option>
                <option value="Black">Black</option>
              </select>
            </div>
<!-- === ROW 3: Repeatability + Amount === -->
            <div style="display: flex; gap: 1rem;">
              <select id="repeatability" required style="width: calc(50% - 0.5rem);">
                <option value="">Repeatability</option>
                <option value="One-off">One-off</option>
                <option value="Recurring">Recurring</option>
              </select>
              <input
                type="number"
                id="amount"
                placeholder="0.00"
                step="0.01"
                min="0"
                inputmode="decimal"
                style="width: calc(50% - 0.5rem); text-align: right; appearance: textfield;"
                required
                />
            </div>
<!-- === ROW 3.1: Recurring Details (hidden by default) === -->
            <div id="recurringFields" style="display: none; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem;">
              <div>
                <label for="endDate">End Date (optional)</label>
                <input type="date" id="endDate" />
              </div>
              <div style="display: flex; gap: 0.5rem;">
                <div style="flex: 1;">
                  <label for="repeatEveryNumber">Repeat every</label>
                  <input type="number" id="repeatEveryNumber" min="1" max="31" value="1" />
                </div>
                <div style="flex: 1;">
                  <label for="repeatEveryUnit" style="visibility: hidden;">Unit</label>
                  <select id="repeatEveryUnit">
                    <option value="day">Day</option>
                    <option value="week">Week</option>
                    <option value="month">Month</option>
                    <option value="year">Year</option>
                  </select>
                </div>
               </div>
              </div>
        
<!-- === ROW 4: Description === -->
            <div style="width: 100%;">
              <input
                type="text"
                id="description"
                placeholder="Description"
                required
                style="width: 100%;"                
                />
            </div>
<!-- === ACTION BUTTONS === -->
            <div style="display: flex; gap: 1rem; margin-top: 1rem;">
              <button type="submit" id="saveExit" style="flex: 1; background-color: #e0e0e0;">Save & Exit</button>
              <button type="submit" id="saveRepeat" style="flex: 1; background-color: #d0f0d0;">Save & Repeat</button>
            </div>
      </form>
    </div>
  </div>

<!-- ========== SCRIPT LOGIC ========== -->
  <script>
    // === FORM + TABLE DOM ELEMENTS ===
    const form = document.getElementById('transactionForm');
    const tableBody = document.querySelector('#transactionsTable tbody');
    let clickedButton = null;

    // === LOAD TRANSACTIONS FROM STORAGE ===
    function loadTransactions() {
      const data = JSON.parse(localStorage.getItem('transactions')) || [];
      tableBody.innerHTML = '';
      data.forEach(tx => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${tx.date}</td>
          <td>${tx.type}</td>
          <td>${tx.amount}</td>
          <td>${tx.category}</td>
          <td>${tx.description}</td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    document.getElementById('saveExit').addEventListener('click', () => {
      clickedButton = 'exit';
    });
    document.getElementById('saveRepeat').addEventListener('click', () => {
      clickedButton = 'repeat';
    });
    // === FORM SUBMIT HANDLER ===
    form.addEventListener('submit', (e) => {
      e.preventDefault(); // üîí Prevents the default page reload

// Gather core fields
    const transaction = {
      date:   document.getElementById('date').value,
      type:   document.getElementById('type').value,
      amount: parseFloat(document.getElementById('amount').value),
      category:    document.getElementById('category').value.trim(),
      description: document.getElementById('description').value.trim(),
// Recurring logic
      repeatability: document.getElementById('repeatability').value
    };

// If this is a recurring transaction, capture the extra fields
    if (transaction.repeatability === 'Recurring') {
      transaction.isRecurring       = true;
      transaction.endDate           = document.getElementById('endDate').value || null;
      transaction.repeatEveryNumber = parseInt(document.getElementById('repeatEveryNumber').value, 10);
      transaction.repeatEveryUnit   = document.getElementById('repeatEveryUnit').value;
    } else {
      transaction.isRecurring       = false;
      transaction.endDate           = null;
      transaction.repeatEveryNumber = null;
      transaction.repeatEveryUnit   = null;
}

  // üì¶ Save to local storage
      
        const data = JSON.parse(localStorage.getItem('transactions')) || [];
          data.push(transaction);
          localStorage.setItem('transactions', JSON.stringify(data));

  // üîÅ Reload the updated table
      
        loadTransactions();

  // üß† Check which button was clicked
          if (clickedButton === 'exit') {
          form.reset();     // Clears all fields
          closePopup();     // Closes the popup window
          } else if (clickedButton === 'repeat') {
          form.reset();     // Clears all fields
          document.getElementById('date').value = new Date().toISOString().split('T')[0]; // Optionally refill today‚Äôs date
          document.getElementById('type').focus(); // Move cursor to first dropdown
          }

          clickedButton = null; // Reset for next submission
          });

    // === PAGE SWITCHING ===
    function goTo(page) {
      const sections = document.querySelectorAll('main > section');
      sections.forEach(sec => sec.classList.remove('active'));

      const pageMap = {
        home: 'homePage',
        transactions: 'transactionsPage',
        projects: 'projectsPage',
        projection: 'projectionPage',
        options: 'optionsPage'
      };

      const targetId = pageMap[page];
      if (targetId) {
        document.getElementById(targetId).classList.add('active');
      }
    }
    
// === POPUP CONTROL ===
    
      function openPopup() {
        document.getElementById("popup").style.display = "flex";
        
// Set the date input to today
        
      const today = new Date().toISOString().split('T')[0];
        document.getElementById("date").value = today;
      }

      function closePopup() {
        document.getElementById("popup").style.display = "none";
      }

// === RECURRING FIELDS TOGGLE ===
       document.getElementById('repeatability').addEventListener('change', function () {
        const recurringFields = document.getElementById('recurringFields');
        if (this.value === 'Recurring') {
          recurringFields.style.display = 'flex';
        } else {
           recurringFields.style.display = 'none';
        }
      });

// === INITIAL LOAD ===
    window.addEventListener('DOMContentLoaded', () => {
      loadTransactions();
      goTo('transactions');
    });
  </script>

</body>
</html>
